{% extends 'share_layout/base.html' %}
{% load blog_tags %}
{% load i18n %}

{% block title %}{% trans 'My Articles' %} | {{ SITE_NAME }}{% endblock %}

{% block content %}
    <div id="primary" class="site-content">
        <div id="content" role="main">
            <header class="archive-header">
                <h1 class="archive-title">{% trans 'My Articles' %}</h1>
                <a href="{% url 'blog:article_create' %}" class="btn btn-primary mt-2">
                    <i class="fa fa-plus"></i> {% trans 'Write New Article' %}
                </a>
            </header>

            {% if articles %}
                <div class="article-list">
                    {% for article in articles %}
                        <article class="post type-post status-publish hentry">
                            <header class="entry-header">
                                <h2 class="entry-title">
                                    <a href="{{ article.get_absolute_url }}" rel="bookmark">{{ article.title }}</a>
                                </h2>
                                <div class="entry-meta">
                                    <span class="posted-on">
                                        <time class="entry-date" datetime="{{ article.pub_time }}">
                                            {% datetimeformat article.pub_time %}
                                        </time>
                                    </span>
                                    <span class="category">
                                        {% trans 'In' %} <a href="{{ article.category.get_absolute_url }}">{{ article.category.name }}</a>
                                    </span>
                                    <span class="views">
                                        {{ article.views }} {% trans 'views' %}
                                    </span>
                                    <span class="comments-link">
                                        <a href="{{ article.get_absolute_url }}#comments">
                                            {{ article.comment_set.count }} {% trans 'comments' %}
                                        </a>
                                    </span>
                                </div>
                            </header>

                            <div class="entry-summary">
                                {{ article.body|truncatechars_content }}
                            </div>

                            <footer class="entry-actions">
                                <a href="{% url 'blog:article_update' article.id %}" class="btn btn-sm btn-outline-primary">
                                    {% trans 'Edit' %}
                                </a>
                                <a href="{{ article.get_absolute_url }}" class="btn btn-sm btn-outline-secondary">
                                    {% trans 'View' %}
                                </a>
                                <button class="btn btn-sm btn-outline-danger float-right"
                                        onclick="if(confirm('{% trans "Are you sure you want to delete this article?" %}')) {
                                            document.getElementById('delete-form-{{ article.id }}').submit();
                                        }">
                                    {% trans 'Delete' %}
                                </button>
                                <form id="delete-form-{{ article.id }}" action="{% url 'blog:article_update' article.id %}" method="post" style="display: none;">
                                    {% csrf_token %}
                                    <input type="hidden" name="action" value="delete">
                                </form>
                            </footer>
                        </article>
                    {% endfor %}
                </div>

                {% if is_paginated %}
                    {% load_pagination_info page_obj "" "" %}
                {% endif %}
            {% else %}
                <div class="alert alert-info">
                    {% trans 'You haven\'t published any articles yet.' %}
                    <a href="{% url 'blog:article_create' %}" class="alert-link">{% trans 'Write your first article!' %}</a>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}

{% block sidebar %}
    {% load_sidebar user 'i' %}
{% endblock %}